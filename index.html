<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lev's Birthday Weekend â€“ Portland 2025</title>
  <style>
    /* SIMPLE, LIGHTWEIGHT STYLES - PHASE 1 */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f5;
      color: #333;
      line-height: 1.6;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    h1 {
      color: #2c5282;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #666;
      margin-bottom: 20px;
    }

    /* Header Info */
    .header-info {
      display: grid;
      gap: 15px;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid #e2e8f0;
    }

    .info-box {
      background: #f7fafc;
      padding: 15px;
      border-radius: 4px;
      border-left: 4px solid #4299e1;
    }

    .info-label {
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 5px;
      font-size: 12px;
      text-transform: uppercase;
    }

    .info-value {
      color: #4a5568;
      font-size: 14px;
    }

    /* Section Groups */
    .section-group-title {
      font-size: 28px;
      font-weight: 700;
      color: #1a365d;
      margin: 40px 0 30px 0;
      padding-bottom: 10px;
      border-bottom: 3px solid #4299e1;
    }

    .section-group-title:first-child {
      margin-top: 20px;
    }

    /* Sections */
    .section {
      margin-bottom: 40px;
    }

    .section-title {
      font-size: 20px;
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 10px;
    }

    .section-description {
      color: #718096;
      margin-bottom: 20px;
      font-size: 14px;
    }

    /* Cards */
    .card-grid {
      display: grid;
      gap: 20px;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    }

    .card {
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.2s;
      background: white;
    }

    .card:hover {
      border-color: #cbd5e0;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .card.selected {
      border-color: #4299e1;
      background: #ebf8ff;
    }

    .card-title {
      font-size: 18px;
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 8px;
    }

    .card-tag {
      display: inline-block;
      background: #edf2f7;
      color: #4a5568;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      margin-bottom: 10px;
      font-weight: 500;
    }

    .card.selected .card-tag {
      background: #bee3f8;
      color: #2c5282;
    }

    .card-description {
      color: #4a5568;
      font-size: 14px;
      margin-bottom: 10px;
      line-height: 1.5;
    }

    .card-details {
      color: #718096;
      font-size: 13px;
      margin-bottom: 12px;
      line-height: 1.4;
    }

    .card-links {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
    }

    .card-link {
      display: inline-block;
      padding: 6px 12px;
      background: #edf2f7;
      color: #4a5568;
      text-decoration: none;
      border-radius: 4px;
      font-size: 12px;
      transition: all 0.2s;
    }

    .card-link:hover {
      background: #e2e8f0;
      color: #2d3748;
    }

    /* Expandable sections */
    .expand-button {
      width: 100%;
      padding: 12px;
      background: #edf2f7;
      border: 2px solid #cbd5e0;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      color: #718096;
      margin-top: 20px;
      transition: all 0.2s;
    }

    .expand-button:hover {
      background: #e2e8f0;
    }

    .expand-button.enabled {
      background: #bee3f8;
      border-color: #4299e1;
      color: #2c5282;
      cursor: pointer;
    }

    .expandable-content {
      display: none;
      margin-top: 20px;
      padding: 20px;
      background: #f7fafc;
      border-radius: 6px;
    }

    .expandable-content.show {
      display: block;
    }

    /* Mini cards for stores */
    .mini-card {
      border: 1px solid #e2e8f0;
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .mini-card:hover {
      border-color: #cbd5e0;
      background: #f7fafc;
    }

    .mini-card.selected {
      border-color: #4299e1;
      background: #ebf8ff;
    }

    .mini-card-title {
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 5px;
    }

    .mini-card-description {
      font-size: 13px;
      color: #4a5568;
      margin-bottom: 8px;
    }

    /* Summary Panel */
    .summary-panel {
      position: sticky;
      top: 20px;
      background: #f7fafc;
      padding: 20px;
      border-radius: 8px;
      border: 2px solid #bee3f8;
      margin-bottom: 30px;
    }

    .summary-title {
      font-size: 18px;
      font-weight: 600;
      color: #2c5282;
      margin-bottom: 15px;
    }

    .summary-section {
      margin-bottom: 15px;
    }

    .summary-section-title {
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 5px;
    }

    .summary-item {
      color: #4a5568;
      font-size: 14px;
      margin-left: 10px;
    }

    .summary-empty {
      color: #718096;
      font-style: italic;
    }

    /* Footer */
    .footer {
      margin-top: 40px;
      padding-top: 20px;
      border-top: 2px solid #e2e8f0;
      text-align: center;
      color: #718096;
    }

    .reset-button {
      margin: 20px 0;
      padding: 10px 20px;
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }

    .reset-button:hover {
      border-color: #fc8181;
      color: #c53030;
    }

    /* Hidden utility */
    .hidden {
      display: none !important;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .card-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Lev's Birthday Weekend</h1>
    <div class="subtitle">Portland, Maine â€¢ December 20-21, 2025</div>

    <!-- Header Info -->
    <div class="header-info">
      <div class="info-box">
        <div class="info-label">Accommodations</div>
        <div class="info-value">AC Hotel Portland Downtown/Waterfront</div>
      </div>
      <div class="info-box">
        <div class="info-label">Goal</div>
        <div class="info-value">Kicking off your 35th rotation around the sun!</div>
      </div>
    </div>

    <!-- Summary Panel -->
    <div class="summary-panel">
      <div class="summary-title">ðŸ”¥ Your Weekend Summary</div>
      <div id="summary-content" class="summary-empty">
        Make selections below to build your weekend!
      </div>
    </div>

    <!-- All Content -->
    <div id="content-container"></div>

    <!-- Footer -->
    <div class="footer">
      <p>Your selections save automatically</p>
      <button class="reset-button" id="reset-btn">Reset All Selections</button>
      <p style="margin-top: 20px; font-size: 16px; color: #2d3748;">Note: You are loved!</p>
    </div>
  </div>

  <script>
    // ============================================
    // CONTENT DATA - EDIT THIS SECTION TO UPDATE ACTIVITIES
    // ============================================
    const CONTENT = {
      // ============================================
      // TAB 1: HEADING OUT
      // ============================================
      headingOut: {
        sections: [
          {
            id: 'departure-time',
            title: 'Choose Your Departure Time',
            description: 'Pick when you want to hit the road',
            selectionType: 'single',
            cards: [
              {
                id: 'depart-10am',
                title: 'Leave at 10:00 AM',
                tag: 'Early Start',
                description: 'Arrive by 12pm, more time in Portland'
              },
              {
                id: 'depart-11am',
                title: 'Leave at 11:00 AM',
                tag: 'Balanced',
                description: 'Arrive by 1pm, good balance'
              },
              {
                id: 'depart-12pm',
                title: 'Leave at 12:00 PM',
                tag: 'Leisurely',
                description: 'Arrive by 2pm, relaxed morning'
              }
            ]
          },
          {
            id: 'before-checkin',
            title: 'Before Check-In Activities',
            description: 'What should we do before 3pm check-in? (Select any)',
            selectionType: 'multiple',
            cards: [
              {
                id: 'arabica',
                title: 'Arabica Coffee House',
                tag: 'Coffee',
                description: 'Local coffee shop with cozy vibes',
                details: '450 Forest Ave â€¢ Open 7am-5pm',
                links: [
                  { text: 'Website', url: 'https://www.arabicacoffeehouse.com' },
                  { text: 'Menu', url: 'https://www.arabicacoffeehouse.com/menu' }
                ]
              },
              {
                id: 'headlight',
                title: 'Headlight Brewing',
                tag: 'Brewery',
                description: 'Craft brewery with great atmosphere',
                details: '590 Forest Ave â€¢ Open 12pm-10pm',
                links: [
                  { text: 'Website', url: 'https://headlightbrewing.com' }
                ]
              },
              {
                id: 'east-end',
                title: 'Explore East End',
                tag: 'Walking',
                description: 'Walk around the artsy East End neighborhood',
                details: 'Galleries, shops, and street art'
              },
              {
                id: 'waterfront-walk',
                title: 'Old Port Waterfront',
                tag: 'Walking',
                description: 'Stroll along the historic waterfront',
                details: 'Scenic views, cobblestone streets'
              }
            ]
          }
        ]
      },

      // ============================================
      // TAB 2: SATURDAY NIGHT
      // ============================================
      saturdayNight: {
        sections: [
          {
            id: 'checkin',
            title: 'Check-In',
            description: 'Arrive at the hotel',
            selectionType: 'none',
            cards: [
              {
                id: 'hotel-checkin',
                title: 'AC Hotel Check-In (3:00 PM)',
                tag: 'Hotel',
                description: 'Drop bags, settle in',
                details: '433 Commercial St'
              }
            ]
          },
          {
            id: 'freshen-up',
            title: 'Freshen Up',
            description: 'Get ready for the evening',
            selectionType: 'none',
            cards: [
              {
                id: 'get-ready',
                title: 'Get Ready',
                tag: 'Prep',
                description: 'Change, relax, prepare for dinner and show'
              }
            ]
          },
          {
            id: 'fantasy-reminder',
            title: 'Fantasy Football',
            description: 'Don\'t forget to set your lineup!',
            selectionType: 'none',
            cards: [
              {
                id: 'ff-lineup',
                title: 'Set Fantasy Lineup',
                tag: 'Important',
                description: 'Week 16 games start Saturday - set your lineup before dinner!',
                details: 'Games at 1pm, 4:25pm, and 8:15pm ET'
              }
            ]
          },
          {
            id: 'dinner',
            title: 'Dinner',
            description: 'Pre-show dinner',
            selectionType: 'multiple',
            cards: [
              {
                id: 'eventide',
                title: 'Eventide Oyster Co.',
                tag: 'Seafood',
                description: 'Award-winning oysters and creative seafood',
                details: '86 Middle St â€¢ 4-9:30pm â€¢ Walk: 5 min',
                links: [
                  { text: 'Website', url: 'https://www.eventideoysterco.com' },
                  { text: 'Menu', url: 'https://www.eventideoysterco.com/portland-menu' }
                ]
              },
              {
                id: 'duckfat',
                title: 'Duckfat',
                tag: 'Comfort Food',
                description: 'Sandwiches, poutine, Belgian fries',
                details: '43 Middle St â€¢ 11am-9pm â€¢ Walk: 5 min',
                links: [
                  { text: 'Website', url: 'https://duckfat.com' }
                ]
              },
              {
                id: 'central-provisions',
                title: 'Central Provisions',
                tag: 'Small Plates',
                description: 'Inventive small plates, excellent cocktails',
                details: '414 Fore St â€¢ 4-10pm â€¢ Walk: 3 min',
                links: [
                  { text: 'Website', url: 'https://www.central-provisions.com' }
                ]
              }
            ]
          },
          {
            id: 'show',
            title: 'Evening Show',
            description: 'Choose your evening entertainment',
            selectionType: 'single',
            cards: [
              {
                id: 'magic-show',
                title: 'Comedy/Magic Show at Jonathan\'s',
                tag: 'Comedy & Magic',
                description: 'Intimate venue with comedy and magic performances',
                details: '92 Bourne St, Ogunquit (40 min drive) â€¢ Show: 8pm',
                links: [
                  { text: 'Website', url: 'https://jonathansogunquit.com' },
                  { text: 'Tickets', url: 'https://jonathansogunquit.com/calendar' }
                ]
              },
              {
                id: 'live-music',
                title: 'Live Music in Portland',
                tag: 'Music',
                description: 'Check local venues for live performances',
                details: 'Port City Music Hall, One Longfellow Square, or State Theatre',
                links: [
                  { text: 'Port City', url: 'https://www.portcitymusichall.com' },
                  { text: 'State Theatre', url: 'https://statetheatreportland.com' }
                ]
              }
            ]
          },
          {
            id: 'late-night',
            title: 'Late Night Options',
            description: 'After the show... (Select any)',
            selectionType: 'multiple',
            expandable: true,
            expandCondition: 'show-selected',
            cards: [
              {
                id: 'novare-res',
                title: 'Novare Res Bier Cafe',
                tag: 'Beer Bar',
                description: '500+ beers, European-style beer cafe',
                details: '4 Canal Plaza â€¢ Open until 1am',
                links: [
                  { text: 'Website', url: 'https://novareresbiercafe.com' }
                ]
              },
              {
                id: 'portland-hunt',
                title: 'Portland Hunt + Alpine Club',
                tag: 'Cocktails',
                description: 'Craft cocktails, cozy alpine-themed bar',
                details: '75 Market St â€¢ Open until 1am',
                links: [
                  { text: 'Website', url: 'https://huntalpine.com' }
                ]
              },
              {
                id: 'brass-fox',
                title: 'The Brass Fox',
                tag: 'Speakeasy',
                description: 'Hidden speakeasy-style cocktail bar',
                details: '92 Exchange St â€¢ Open until 1am'
              },
              {
                id: 'arcade',
                title: 'Arcadia National Bar',
                tag: 'Arcade Bar',
                description: 'Retro arcade games and drinks',
                details: '21 Hanover St â€¢ Open until 1am',
                links: [
                  { text: 'Website', url: 'https://arcadianationalbar.com' }
                ]
              },
              {
                id: 'hotel-bar',
                title: 'Back to Hotel Bar',
                tag: 'Nightcap',
                description: 'Wind down at the AC Hotel bar',
                details: 'Convenient, no travel needed'
              }
            ]
          }
        ]
      },

      // ============================================
      // TAB 3: SUNDAY
      // ============================================
      sunday: {
        sections: [
          {
            id: 'early-morning',
            title: 'Early Morning',
            description: 'Start the day relaxed',
            selectionType: 'multiple',
            cards: [
              {
                id: 'baths',
                title: 'Hot Baths',
                tag: 'Relaxation',
                description: 'Hydrotherapy baths at East End neighborhood spot',
                details: 'Portland Salt Co. - 547 Washington Ave â€¢ Book ahead',
                links: [
                  { text: 'Website', url: 'https://www.portlandsaltco.com' },
                  { text: 'Book', url: 'https://www.portlandsaltco.com/book-now' }
                ]
              }
            ]
          },
          {
            id: 'brunch',
            title: 'Sunday Brunch',
            description: 'Pick your brunch spot',
            selectionType: 'single',
            cards: [
              {
                id: 'duckfat-brunch',
                title: 'Duckfat',
                tag: 'Comfort',
                description: 'Breakfast sandwiches and famous fries',
                details: '43 Middle St â€¢ 11am-9pm',
                links: [
                  { text: 'Website', url: 'https://duckfat.com' }
                ]
              },
              {
                id: 'becky-diner',
                title: 'Becky\'s Diner',
                tag: 'Classic',
                description: 'Portland institution, hearty breakfast',
                details: '390 Commercial St â€¢ 5am-9pm',
                links: [
                  { text: 'Website', url: 'https://beckysdiner.com' }
                ]
              },
              {
                id: 'brunch-hotel',
                title: 'Hotel Breakfast',
                tag: 'Easy',
                description: 'Convenient breakfast at AC Hotel',
                details: 'No travel, relaxed start'
              }
            ]
          },
          {
            id: 'checkout',
            title: 'Hotel Checkout',
            description: 'Pack up and check out',
            selectionType: 'none',
            cards: [
              {
                id: 'hotel-checkout',
                title: 'Check Out (11:00 AM)',
                tag: 'Hotel',
                description: 'Pack bags, check out, load car',
                details: 'Can usually get late checkout if needed'
              }
            ]
          },
          {
            id: 'afternoon',
            title: 'Sunday Afternoon Activities',
            description: 'Before heading home... (Select any)',
            selectionType: 'multiple',
            cards: [
              {
                id: 'shopping',
                title: 'Shopping in Old Port',
                tag: 'Shopping',
                description: 'Browse unique stores and boutiques',
                details: 'Exchange St, Commercial St, Fore St',
                expandable: true,
                stores: [
                  {
                    id: 'maine-store',
                    name: 'Ferdinand',
                    description: 'Curated Maine-made goods and vintage',
                    location: '243 Congress St'
                  },
                  {
                    id: 'bookstore',
                    name: 'Longfellow Books',
                    description: 'Independent bookstore',
                    location: '1 Monument Way'
                  },
                  {
                    id: 'outdoor',
                    name: 'Lisa-Marie\'s Made in Maine',
                    description: 'Local artisan products',
                    location: '46 Exchange St'
                  },
                  {
                    id: 'vintage',
                    name: 'Blanche & Mimi',
                    description: 'Vintage clothing and accessories',
                    location: '25 Exchange St'
                  },
                  {
                    id: 'mens',
                    name: 'OTB',
                    description: 'Men\'s clothing and accessories',
                    location: '10 Moulton St'
                  },
                  {
                    id: 'record',
                    name: 'Bull Moose Music',
                    description: 'Records, CDs, books, movies',
                    location: '151 Middle St'
                  }
                ]
              },
              {
                id: 'museum',
                title: 'Portland Museum of Art',
                tag: 'Culture',
                description: 'Art museum with strong regional collection',
                details: '7 Congress Square â€¢ 10am-6pm Sunday',
                links: [
                  { text: 'Website', url: 'https://www.portlandmuseum.org' }
                ]
              },
              {
                id: 'eastern-prom',
                title: 'Eastern Promenade',
                tag: 'Outdoors',
                description: 'Waterfront park with harbor views',
                details: 'Great for a walk before leaving town'
              },
              {
                id: 'coffee-final',
                title: 'Final Coffee Stop',
                tag: 'Coffee',
                description: 'Grab coffee for the road',
                details: 'Tandem Coffee, Coffee by Design, or Arabica'
              }
            ]
          }
        ]
      },

      // ============================================
      // TAB 4: HEADING HOME
      // ============================================
      headingHome: {
        sections: [
          {
            id: 'fun-stops',
            title: 'Fun Stops on the Way Home',
            description: 'Break up the drive back (Select any)',
            selectionType: 'multiple',
            cards: [
              {
                id: 'freeport',
                title: 'Freeport Outlets',
                tag: 'Shopping',
                description: 'L.L.Bean flagship and outlet shopping',
                details: '20 min south of Portland â€¢ L.L.Bean open 24/7',
                links: [
                  { text: 'L.L.Bean', url: 'https://www.llbean.com/llb/shop/518672' }
                ]
              },
              {
                id: 'kennebunkport',
                title: 'Kennebunkport',
                tag: 'Scenic',
                description: 'Charming coastal town worth a stroll',
                details: '30 min south of Portland â€¢ Dock Square, ocean views'
              }
            ]
          },
          {
            id: 'playlists',
            title: 'Road Trip Playlists',
            description: 'Music for the drive home (Select any)',
            selectionType: 'multiple',
            cards: [
              {
                id: 'playlist-chill',
                title: 'Chill Vibes',
                tag: 'Relaxed',
                description: 'Mellow tunes for a relaxed drive home'
              },
              {
                id: 'playlist-energy',
                title: 'Energy Boost',
                tag: 'Upbeat',
                description: 'Upbeat music to keep energy up'
              },
              {
                id: 'playlist-throwback',
                title: 'Throwback Hits',
                tag: 'Nostalgia',
                description: 'Classic hits and sing-alongs'
              },
              {
                id: 'podcast',
                title: 'Podcast Time',
                tag: 'Audio',
                description: 'Catch up on favorite podcasts'
              }
            ]
          }
        ]
      }
    };

    // ============================================
    // STATE MANAGEMENT
    // ============================================
    let selections = {
      headingOut: {},
      saturdayNight: {},
      sunday: {},
      headingHome: {}
    };

    // Load saved selections from localStorage
    function loadSelections() {
      const saved = localStorage.getItem('lev-bday-2025');
      if (saved) {
        try {
          selections = JSON.parse(saved);
        } catch (e) {
          console.error('Error loading selections:', e);
        }
      }
    }

    // Save selections to localStorage
    function saveSelections() {
      localStorage.setItem('lev-bday-2025', JSON.stringify(selections));
    }

    // ============================================
    // RENDERING FUNCTIONS
    // ============================================

    function renderCard(card, sectionId, selectionType, tabKey) {
      const isSelected = selections[tabKey][sectionId]?.includes(card.id);

      let html = `
        <div class="card ${isSelected ? 'selected' : ''}"
             data-card-id="${card.id}"
             data-section-id="${sectionId}"
             data-selection-type="${selectionType}"
             data-tab-key="${tabKey}">
          <div class="card-tag">${card.tag}</div>
          <div class="card-title">${card.title}</div>
          ${card.description ? `<div class="card-description">${card.description}</div>` : ''}
          ${card.details ? `<div class="card-details">${card.details}</div>` : ''}
      `;

      if (card.links && card.links.length > 0) {
        html += '<div class="card-links">';
        card.links.forEach(link => {
          html += `<a href="${link.url}" class="card-link" target="_blank" onclick="event.stopPropagation()">${link.text}</a>`;
        });
        html += '</div>';
      }

      // Shopping stores expandable
      if (card.stores && card.stores.length > 0) {
        const expandId = `expand-${card.id}`;
        html += `
          <button class="expand-button ${isSelected ? 'enabled' : ''}" id="expand-btn-${card.id}" onclick="toggleExpand('${expandId}', event)">
            ${isSelected ? 'Show Store Details â–¼' : 'Select to see store options'}
          </button>
          <div class="expandable-content ${isSelected ? 'show' : ''}" id="${expandId}">
        `;

        card.stores.forEach(store => {
          const storeSelected = selections[tabKey][`${sectionId}-stores`]?.includes(store.id);
          html += `
            <div class="mini-card ${storeSelected ? 'selected' : ''}"
                 data-card-id="${store.id}"
                 data-section-id="${sectionId}-stores"
                 data-selection-type="multiple"
                 onclick="handleCardClick('${sectionId}-stores', '${store.id}', 'multiple', '${tabKey}', event)">
              <div class="mini-card-title">${store.name}</div>
              <div class="mini-card-description">${store.description}</div>
              <div class="card-details">${store.location}</div>
            </div>
          `;
        });

        html += '</div>';
      }

      html += '</div>';
      return html;
    }

    function renderSection(section, tabKey) {
      let html = `
        <div class="section">
          <h2 class="section-title">${section.title}</h2>
          ${section.description ? `<div class="section-description">${section.description}</div>` : ''}
          <div class="card-grid">
      `;

      section.cards.forEach(card => {
        html += renderCard(card, section.id, section.selectionType, tabKey);
      });

      html += '</div>';

      // Late night expandable (shows after selecting a show)
      if (section.expandable && section.expandCondition === 'show-selected') {
        const showSelected = selections[tabKey]['show'] && selections[tabKey]['show'].length > 0;
        html += `
          <div class="expandable-content ${showSelected ? 'show' : ''}" id="expand-late-night">
            <!-- Late night cards already rendered above -->
          </div>
        `;
      }

      html += '</div>';
      return html;
    }

    function renderAllContent() {
      const container = document.getElementById('content-container');
      let html = '';

      // Heading Out
      html += '<h2 class="section-group-title">Heading Out</h2>';
      CONTENT.headingOut.sections.forEach(section => {
        html += renderSection(section, 'headingOut');
      });

      // Saturday Night
      html += '<h2 class="section-group-title">Saturday Night</h2>';
      CONTENT.saturdayNight.sections.forEach(section => {
        if (section.expandable && section.expandCondition === 'show-selected') {
          const showSelected = selections.saturdayNight['show'] && selections.saturdayNight['show'].length > 0;
          if (showSelected) {
            html += renderSection(section, 'saturdayNight');
          }
        } else {
          html += renderSection(section, 'saturdayNight');
        }
      });

      // Sunday
      html += '<h2 class="section-group-title">Sunday</h2>';
      CONTENT.sunday.sections.forEach(section => {
        html += renderSection(section, 'sunday');
      });

      // Heading Home
      html += '<h2 class="section-group-title">Heading Home</h2>';
      CONTENT.headingHome.sections.forEach(section => {
        html += renderSection(section, 'headingHome');
      });

      container.innerHTML = html;

      // Attach click handlers to all cards
      attachCardHandlers();
    }

    // ============================================
    // EVENT HANDLERS
    // ============================================

    function attachCardHandlers() {
      document.querySelectorAll('.card').forEach(card => {
        if (card.dataset.selectionType !== 'none') {
          card.addEventListener('click', (e) => {
            const sectionId = card.dataset.sectionId;
            const cardId = card.dataset.cardId;
            const selectionType = card.dataset.selectionType;
            const tabKey = card.dataset.tabKey;
            handleCardClick(sectionId, cardId, selectionType, tabKey, e);
          });
        }
      });
    }

    function handleCardClick(sectionId, cardId, selectionType, tabKey, event) {
      if (event) event.stopPropagation();

      if (!selections[tabKey][sectionId]) {
        selections[tabKey][sectionId] = [];
      }

      if (selectionType === 'single') {
        // Radio button behavior
        selections[tabKey][sectionId] = [cardId];
      } else {
        // Multiple selection
        const index = selections[tabKey][sectionId].indexOf(cardId);
        if (index > -1) {
          selections[tabKey][sectionId].splice(index, 1);
        } else {
          selections[tabKey][sectionId].push(cardId);
        }
      }

      saveSelections();
      renderAllContent();
      updateSummary();

      // Handle expandables
      if (sectionId === 'show') {
        updateLateNightVisibility();
      }
    }

    function toggleExpand(expandId, event) {
      event.stopPropagation();
      const element = document.getElementById(expandId);
      element.classList.toggle('show');
    }

    function updateLateNightVisibility() {
      const showSelected = selections.saturdayNight['show'] && selections.saturdayNight['show'].length > 0;
      const lateNightSection = document.getElementById('expand-late-night');
      if (lateNightSection) {
        if (showSelected) {
          lateNightSection.classList.add('show');
        } else {
          lateNightSection.classList.remove('show');
        }
      }
    }

    // ============================================
    // SUMMARY PANEL
    // ============================================

    function updateSummary() {
      const summaryContent = document.getElementById('summary-content');
      let html = '';
      let hasSelections = false;

      // Helper to get card title by ID
      function getCardTitle(tabKey, sectionId, cardId) {
        const tab = CONTENT[tabKey.replace(/-/g, '')];
        if (!tab) return cardId;

        for (const section of tab.sections) {
          if (section.id === sectionId) {
            const card = section.cards.find(c => c.id === cardId);
            if (card) return card.title;
          }

          // Check stores
          for (const card of section.cards) {
            if (card.stores && sectionId.includes('stores')) {
              const store = card.stores.find(s => s.id === cardId);
              if (store) return store.name;
            }
          }
        }
        return cardId;
      }

      // Heading Out
      if (Object.keys(selections.headingOut).length > 0) {
        html += '<div class="summary-section"><div class="summary-section-title">Heading Out</div>';
        for (const [sectionId, cardIds] of Object.entries(selections.headingOut)) {
          if (cardIds.length > 0) {
            cardIds.forEach(cardId => {
              html += `<div class="summary-item">â€¢ ${getCardTitle('heading-out', sectionId, cardId)}</div>`;
              hasSelections = true;
            });
          }
        }
        html += '</div>';
      }

      // Saturday Night
      if (Object.keys(selections.saturdayNight).length > 0) {
        html += '<div class="summary-section"><div class="summary-section-title">Saturday Night</div>';
        for (const [sectionId, cardIds] of Object.entries(selections.saturdayNight)) {
          if (cardIds.length > 0) {
            cardIds.forEach(cardId => {
              html += `<div class="summary-item">â€¢ ${getCardTitle('saturday-night', sectionId, cardId)}</div>`;
              hasSelections = true;
            });
          }
        }
        html += '</div>';
      }

      // Sunday
      if (Object.keys(selections.sunday).length > 0) {
        html += '<div class="summary-section"><div class="summary-section-title">Sunday</div>';
        for (const [sectionId, cardIds] of Object.entries(selections.sunday)) {
          if (cardIds.length > 0) {
            cardIds.forEach(cardId => {
              html += `<div class="summary-item">â€¢ ${getCardTitle('sunday', sectionId, cardId)}</div>`;
              hasSelections = true;
            });
          }
        }
        html += '</div>';
      }

      // Heading Home
      if (Object.keys(selections.headingHome).length > 0) {
        html += '<div class="summary-section"><div class="summary-section-title">Heading Home</div>';
        for (const [sectionId, cardIds] of Object.entries(selections.headingHome)) {
          if (cardIds.length > 0) {
            cardIds.forEach(cardId => {
              html += `<div class="summary-item">â€¢ ${getCardTitle('heading-home', sectionId, cardId)}</div>`;
              hasSelections = true;
            });
          }
        }
        html += '</div>';
      }

      if (!hasSelections) {
        summaryContent.innerHTML = '<div class="summary-empty">Make selections below to build your weekend!</div>';
      } else {
        summaryContent.innerHTML = html;
      }
    }

    // ============================================
    // INITIALIZATION
    // ============================================

    document.addEventListener('DOMContentLoaded', function() {
      // Load saved selections
      loadSelections();

      // Render all content
      renderAllContent();

      // Update summary
      updateSummary();

      // Reset button
      document.getElementById('reset-btn').addEventListener('click', () => {
        if (confirm('Reset all selections? This cannot be undone.')) {
          selections = {
            headingOut: {},
            saturdayNight: {},
            sunday: {},
            headingHome: {}
          };
          saveSelections();
          renderAllContent();
          updateSummary();
        }
      });
    });
  </script>
</body>
</html>